@using System.Linq
@using MusicMatch.Models

<div class="search-results p-4 bg-white text-gray-800">
    @if ((ViewBag.Users as IEnumerable<ApplicationUser>)?.Any() == true)
    {
        <h2 class="text-xl font-semibold mb-4 text-gray-800">Users</h2>
        <div class="grid grid-cols-1 gap-4 mb-6">
            @foreach (var user in ViewBag.Users)
            {
                <div class="bg-gray-50 rounded-lg p-4 hover:bg-gray-100">
                    <div class="flex items-center space-x-4">
                        <div class="flex-shrink-0">
                            @if (!string.IsNullOrEmpty(user.PhotoUrl))
                            {
                                <img src="@user.PhotoUrl" alt="Profile" class="w-12 h-12 rounded-full" />
                            }
                            else
                            {
                                <div class="w-12 h-12 rounded-full bg-gray-200 flex items-center justify-center">
                                    <span class="text-xl text-gray-500">@user.FirstName?.FirstOrDefault()@user.LastName?.FirstOrDefault()</span>
                                </div>
                            }
                        </div>
                        <div>
                            <h3 class="text-lg font-medium text-gray-800">@user.FirstName @user.LastName</h3>
                            <p class="text-sm text-gray-600">@user.Email</p>
                        </div>
                    </div>
                </div>
            }
        </div>
    }

    @if ((ViewBag.Artists as IEnumerable<Artist>)?.Any() == true)
    {
        <h2 class="text-xl font-semibold mt-6 mb-4 text-gray-800">Artists</h2>
        <div class="grid grid-cols-1 gap-4 mb-6">
            @foreach (var artist in ViewBag.Artists)
            {
                <div class="bg-gray-50 rounded-lg p-4 hover:bg-gray-100">
                    <div class="flex items-center space-x-4">
                        <div class="flex-shrink-0">
                            @if (!string.IsNullOrEmpty(artist.PhotoUrl))
                            {
                                <img src="@artist.PhotoUrl" alt="Artist" class="w-12 h-12 rounded-full" />
                            }
                            else
                            {
                                <div class="w-12 h-12 rounded-full bg-gray-200 flex items-center justify-center">
                                    <span class="text-xl text-gray-500">@artist.Name?.FirstOrDefault()</span>
                                </div>
                            }
                        </div>
                        <div>
                            <h3 class="text-lg font-medium text-gray-800">@artist.Name</h3>
                            @if (!string.IsNullOrEmpty(artist.Bio))
                            {
                                <p class="text-sm text-gray-600">@(artist.Bio.Length > 100 ? artist.Bio.Substring(0, 97) + "..." : artist.Bio)</p>
                            }
                        </div>
                    </div>
                </div>
            }
        </div>
    }

    @if ((ViewBag.Songs as IEnumerable<Song>)?.Any() == true)
    {
        <h2 class="text-xl font-semibold mt-6 mb-4 text-gray-800">Songs</h2>
        <div class="grid grid-cols-1 gap-4">
            @foreach (var song in ViewBag.Songs)
            {
                <div class="bg-gray-50 rounded-lg p-4 hover:bg-gray-100">
                    <div class="flex justify-between items-center">
                        <div>
                            <h3 class="text-lg font-medium text-gray-800">@song.Title</h3>
                            @if (song.Artist != null)
                            {
                                <p class="text-sm text-gray-600">by @song.Artist.Name</p>
                            }
                            @if (song.Genre != null)
                            {
                                <p class="text-xs text-gray-500">Genre: @song.Genre.Name</p>
                            }
                        </div>
                        <span class="text-sm text-gray-500">@song.Duration.ToString(@"mm\:ss")</span>
                    </div>
                </div>
            }
        </div>
    }

    @if (!(ViewBag.Users as IEnumerable<ApplicationUser>)?.Any() == true &&
    !(ViewBag.Artists as IEnumerable<Artist>)?.Any() == true &&
    !(ViewBag.Songs as IEnumerable<Song>)?.Any() == true)
    {
        <p class="text-center text-gray-500 py-4">No results found</p>
    }
</div>